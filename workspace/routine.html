<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>일과 관리</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .routine-container { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }
        .time-slots { background: var(--bg-dark); padding: 20px; border-radius: 15px; height: fit-content; }
        .time-block { display: grid; grid-template-columns: 80px 1fr; gap: 10px; margin-bottom: 10px; }
        .time-label { background: var(--bg-hover); padding: 10px; border-radius: 8px; 
                     text-align: center; font-weight: bold; }
        .activity-slot { background: var(--bg-hover); padding: 15px; border-radius: 8px; 
                        min-height: 50px; cursor: pointer; display: flex; align-items: center; 
                        justify-content: space-between; }
        .activity-slot.active { background: var(--primary); color: white; }
        .activity-slot.current { border: 2px solid var(--secondary); }
        .templates { background: var(--bg-dark); padding: 20px; border-radius: 15px; }
        .template-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); 
                        gap: 10px; margin-top: 15px; }
        .template-item { background: var(--bg-hover); padding: 15px; border-radius: 10px; 
                        text-align: center; cursor: pointer; transition: all 0.3s; }
        .template-item:hover { background: var(--primary); color: white; transform: translateY(-3px); }
        .template-icon { font-size: 2em; margin-bottom: 5px; }
        .preset-buttons { display: flex; gap: 10px; margin-bottom: 20px; }
        .preset-btn { flex: 1; padding: 10px; background: var(--bg-dark); border: 2px solid var(--border); 
                     border-radius: 10px; cursor: pointer; }
        .preset-btn:hover { background: var(--primary); color: white; border-color: var(--primary); }
        @media (max-width: 768px) { .routine-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="page-header">
            <a href="index.html" class="back-btn">← 뒤로</a>
            <h1>일과 관리</h1>
        </div>
        
        <div class="content">
            <div class="preset-buttons">
                <button class="preset-btn" onclick="loadPreset('weekday')">평일</button>
                <button class="preset-btn" onclick="loadPreset('weekend')">주말</button>
                <button class="preset-btn" onclick="loadPreset('training')">훈련</button>
                <button class="preset-btn" onclick="clearRoutine()">초기화</button>
            </div>
            
            <div class="routine-container">
                <div class="time-slots">
                    <h3>오늘의 일과</h3>
                    <div id="timeSlots"></div>
                </div>
                
                <div class="templates">
                    <h3>활동 템플릿 (클릭하여 추가)</h3>
                    <div class="template-grid">
                        <div class="template-item" onclick="addActivity('기상/세면', '🌅')">
                            <div class="template-icon">🌅</div>
                            <div>기상/세면</div>
                        </div>
                        <div class="template-item" onclick="addActivity('아침식사', '🍳')">
                            <div class="template-icon">🍳</div>
                            <div>아침식사</div>
                        </div>
                        <div class="template-item" onclick="addActivity('점심식사', '🍱')">
                            <div class="template-icon">🍱</div>
                            <div>점심식사</div>
                        </div>
                        <div class="template-item" onclick="addActivity('저녁식사', '🍽️')">
                            <div class="template-icon">🍽️</div>
                            <div>저녁식사</div>
                        </div>
                        <div class="template-item" onclick="addActivity('교육/훈련', '📚')">
                            <div class="template-icon">📚</div>
                            <div>교육/훈련</div>
                        </div>
                        <div class="template-item" onclick="addActivity('작업/근무', '💼')">
                            <div class="template-icon">💼</div>
                            <div>작업/근무</div>
                        </div>
                        <div class="template-item" onclick="addActivity('체력단련', '💪')">
                            <div class="template-icon">💪</div>
                            <div>체력단련</div>
                        </div>
                        <div class="template-item" onclick="addActivity('휴식시간', '☕')">
                            <div class="template-icon">☕</div>
                            <div>휴식시간</div>
                        </div>
                        <div class="template-item" onclick="addActivity('개인정비', '🧹')">
                            <div class="template-icon">🧹</div>
                            <div>개인정비</div>
                        </div>
                        <div class="template-item" onclick="addActivity('자유시간', '🎮')">
                            <div class="template-icon">🎮</div>
                            <div>자유시간</div>
                        </div>
                        <div class="template-item" onclick="addActivity('취침준비', '🌙')">
                            <div class="template-icon">🌙</div>
                            <div>취침준비</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let routine = JSON.parse(localStorage.getItem('routine')) || {};
        let selectedTime = null;
        
        function generateTimeSlots() {
            const container = document.getElementById('timeSlots');
            container.innerHTML = '';
            
            for (let hour = 5; hour < 24; hour++) {
                for (let minute = 0; minute < 60; minute += 30) {
                    const timeKey = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    const timeBlock = document.createElement('div');
                    timeBlock.className = 'time-block';
                    
                    const timeLabel = document.createElement('div');
                    timeLabel.className = 'time-label';
                    timeLabel.textContent = timeKey;
                    
                    const activitySlot = document.createElement('div');
                    activitySlot.className = 'activity-slot';
                    activitySlot.dataset.time = timeKey;
                    
                    // 현재 시간 표시
                    const now = new Date();
                    const currentTime = `${now.getHours().toString().padStart(2, '0')}:${(Math.floor(now.getMinutes() / 30) * 30).toString().padStart(2, '0')}`;
                    if (timeKey === currentTime) {
                        activitySlot.classList.add('current');
                    }
                    
                    // 저장된 활동 표시
                    if (routine[timeKey]) {
                        activitySlot.classList.add('active');
                        activitySlot.innerHTML = `
                            <span>${routine[timeKey].icon} ${routine[timeKey].name}</span>
                            <button onclick="removeActivity('${timeKey}', event)" style="padding: 5px 10px;">×</button>
                        `;
                    } else {
                        activitySlot.textContent = '클릭하여 추가';
                        activitySlot.onclick = () => selectTime(timeKey);
                    }
                    
                    timeBlock.appendChild(timeLabel);
                    timeBlock.appendChild(activitySlot);
                    container.appendChild(timeBlock);
                }
            }
        }
        
        function selectTime(time) {
            selectedTime = time;
            alert(`${time}에 추가할 활동을 선택하세요.`);
        }
        
        function addActivity(name, icon) {
            if (!selectedTime) {
                alert('먼저 시간을 선택하세요.');
                return;
            }
            
            routine[selectedTime] = { name, icon };
            saveRoutine();
            generateTimeSlots();
            selectedTime = null;
        }
        
        function removeActivity(time, event) {
            event.stopPropagation();
            delete routine[time];
            saveRoutine();
            generateTimeSlots();
        }
        
        function saveRoutine() {
            localStorage.setItem('routine', JSON.stringify(routine));
        }
        
        function loadPreset(type) {
            const presets = {
                weekday: {
                    '06:00': { name: '기상/세면', icon: '🌅' },
                    '06:30': { name: '아침식사', icon: '🍳' },
                    '08:00': { name: '작업/근무', icon: '💼' },
                    '12:00': { name: '점심식사', icon: '🍱' },
                    '13:00': { name: '작업/근무', icon: '💼' },
                    '17:00': { name: '체력단련', icon: '💪' },
                    '18:00': { name: '저녁식사', icon: '🍽️' },
                    '19:00': { name: '개인정비', icon: '🧹' },
                    '20:00': { name: '자유시간', icon: '🎮' },
                    '22:00': { name: '취침준비', icon: '🌙' }
                },
                weekend: {
                    '07:00': { name: '기상/세면', icon: '🌅' },
                    '08:00': { name: '아침식사', icon: '🍳' },
                    '09:00': { name: '자유시간', icon: '🎮' },
                    '12:00': { name: '점심식사', icon: '🍱' },
                    '13:00': { name: '휴식시간', icon: '☕' },
                    '18:00': { name: '저녁식사', icon: '🍽️' },
                    '19:00': { name: '자유시간', icon: '🎮' },
                    '22:00': { name: '취침준비', icon: '🌙' }
                },
                training: {
                    '05:30': { name: '기상/세면', icon: '🌅' },
                    '06:00': { name: '아침식사', icon: '🍳' },
                    '07:00': { name: '교육/훈련', icon: '📚' },
                    '12:00': { name: '점심식사', icon: '🍱' },
                    '13:00': { name: '교육/훈련', icon: '📚' },
                    '18:00': { name: '저녁식사', icon: '🍽️' },
                    '19:00': { name: '개인정비', icon: '🧹' },
                    '21:00': { name: '취침준비', icon: '🌙' }
                }
            };
            
            routine = presets[type] || {};
            saveRoutine();
            generateTimeSlots();
        }
        
        function clearRoutine() {
            if (confirm('모든 일과를 삭제하시겠습니까?')) {
                routine = {};
                saveRoutine();
                generateTimeSlots();
            }
        }
        
        generateTimeSlots();
        setInterval(() => generateTimeSlots(), 30000); // 30초마다 현재 시간 업데이트
    </script>
</body>
</html>