<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”½ì…€ ìš°ì£¼</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body { background: #000; overflow: hidden; }
        .space-container { position: relative; width: 100%; height: 100vh; }
        .space-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .ui-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        .ui-panel { position: absolute; background: rgba(0,0,0,0.8); border: 2px solid var(--primary); 
                   border-radius: 10px; padding: 20px; color: white; pointer-events: all; }
        .top-panel { top: 20px; left: 20px; }
        .right-panel { top: 20px; right: 20px; max-width: 300px; }
        .bottom-panel { bottom: 20px; left: 50%; transform: translateX(-50%); }
        
        .resource { display: flex; align-items: center; gap: 10px; margin: 5px 0; }
        .resource-icon { font-size: 1.5em; }
        .resource-amount { font-weight: bold; color: var(--primary); }
        
        .planet-info { margin-top: 20px; }
        .planet-name { font-size: 1.5em; font-weight: bold; margin-bottom: 10px; }
        .planet-stat { margin: 5px 0; font-size: 0.9em; }
        
        .action-buttons { display: flex; gap: 10px; flex-wrap: wrap; }
        .action-btn { background: var(--primary); border: none; color: white; padding: 10px 20px; 
                     border-radius: 5px; cursor: pointer; transition: all 0.3s; }
        .action-btn:hover { background: var(--secondary); transform: scale(1.05); }
        .action-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .ship { position: absolute; font-size: 2em; transition: all 1s ease-in-out; z-index: 10; }
        .planet { position: absolute; border-radius: 50%; cursor: pointer; transition: all 0.3s; }
        .planet:hover { transform: scale(1.1); box-shadow: 0 0 20px rgba(255,255,255,0.5); }
        
        .star { position: absolute; background: white; border-radius: 50%; }
        
        .discovery-log { max-height: 200px; overflow-y: auto; margin-top: 20px; }
        .log-entry { margin: 5px 0; padding: 5px; background: rgba(255,255,255,0.1); 
                    border-radius: 5px; font-size: 0.9em; }
        
        @media (max-width: 768px) {
            .ui-panel { font-size: 0.9em; padding: 15px; }
            .right-panel { max-width: 200px; }
            .action-buttons { flex-direction: column; }
            .action-btn { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="space-container">
        <canvas class="space-canvas" id="spaceCanvas"></canvas>
        
        <div class="ui-overlay">
            <div class="ui-panel top-panel">
                <h2 style="margin: 0 0 10px 0;">ğŸš€ ìš°ì£¼ íƒí—˜</h2>
                <div class="resource">
                    <span class="resource-icon">âš¡</span>
                    <span>ì—ë„ˆì§€: <span class="resource-amount" id="energy">100</span></span>
                </div>
                <div class="resource">
                    <span class="resource-icon">ğŸ’</span>
                    <span>í¬ë¦¬ìŠ¤íƒˆ: <span class="resource-amount" id="crystal">0</span></span>
                </div>
                <div class="resource">
                    <span class="resource-icon">ğŸª</span>
                    <span>ë°œê²¬ í–‰ì„±: <span class="resource-amount" id="discovered">0</span></span>
                </div>
            </div>
            
            <div class="ui-panel right-panel">
                <div class="planet-info" id="planetInfo" style="display: none;">
                    <div class="planet-name" id="planetName">-</div>
                    <div class="planet-stat">ê±°ë¦¬: <span id="planetDistance">-</span> ê´‘ë…„</div>
                    <div class="planet-stat">í¬ê¸°: <span id="planetSize">-</span></div>
                    <div class="planet-stat">ìì›: <span id="planetResource">-</span></div>
                    <div class="action-buttons">
                        <button class="action-btn" onclick="explorePlanet()">íƒì‚¬í•˜ê¸°</button>
                        <button class="action-btn" onclick="colonizePlanet()">ì‹ë¯¼ì§€í™”</button>
                    </div>
                </div>
                
                <div class="discovery-log">
                    <h3>íƒí—˜ ì¼ì§€</h3>
                    <div id="logEntries"></div>
                </div>
            </div>
            
            <div class="ui-panel bottom-panel">
                <button class="action-btn" onclick="scanArea()">ì£¼ë³€ ìŠ¤ìº” (10 ì—ë„ˆì§€)</button>
                <button class="action-btn" onclick="warpJump()">ì›Œí”„ ì í”„ (50 ì—ë„ˆì§€)</button>
                <a href="index.html" class="action-btn" style="background: var(--danger);">ì¢…ë£Œ</a>
            </div>
        </div>
        
        <div class="ship" id="ship">ğŸš€</div>
    </div>
    
    <script>
        const canvas = document.getElementById('spaceCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        let gameState = JSON.parse(localStorage.getItem('spaceExplorer')) || {
            energy: 100,
            crystal: 0,
            discovered: 0,
            shipX: canvas.width / 2,
            shipY: canvas.height / 2,
            planets: [],
            logs: []
        };
        
        let selectedPlanet = null;
        const stars = [];
        
        // ë³„ ìƒì„±
        function createStars() {
            for (let i = 0; i < 200; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2,
                    brightness: Math.random()
                });
            }
        }
        
        // ë³„ ê·¸ë¦¬ê¸°
        function drawStars() {
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            stars.forEach(star => {
                ctx.fillStyle = `rgba(255, 255, 255, ${star.brightness})`;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
            });
        }
        
        // í–‰ì„± ìƒì„±
        function generatePlanet(x, y) {
            const types = ['ğŸ”´', 'ğŸ”µ', 'ğŸŸ¢', 'ğŸŸ¡', 'ğŸŸ£', 'ğŸŸ '];
            const names = ['ì•ŒíŒŒ', 'ë² íƒ€', 'ê°ë§ˆ', 'ë¸íƒ€', 'ì—¡ì‹¤ë¡ ', 'ì œíƒ€', 'ì—íƒ€', 'ì„¸íƒ€'];
            const resources = ['ì—ë„ˆì§€', 'í¬ë¦¬ìŠ¤íƒˆ', 'ê¸ˆì†', 'ê°€ìŠ¤', 'ë¬¼', 'ìƒëª…ì²´'];
            
            return {
                id: Date.now(),
                x: x || Math.random() * canvas.width,
                y: y || Math.random() * canvas.height,
                type: types[Math.floor(Math.random() * types.length)],
                name: names[Math.floor(Math.random() * names.length)] + '-' + Math.floor(Math.random() * 999),
                size: Math.random() * 30 + 20,
                resource: resources[Math.floor(Math.random() * resources.length)],
                resourceAmount: Math.floor(Math.random() * 100) + 10,
                explored: false,
                colonized: false
            };
        }
        
        // í–‰ì„± ê·¸ë¦¬ê¸°
        function drawPlanets() {
            gameState.planets.forEach(planet => {
                const el = document.createElement('div');
                el.className = 'planet';
                el.style.left = planet.x + 'px';
                el.style.top = planet.y + 'px';
                el.style.fontSize = planet.size + 'px';
                el.textContent = planet.type;
                el.onclick = () => selectPlanet(planet);
                
                if (planet.explored) {
                    el.style.border = '2px solid var(--secondary)';
                }
                if (planet.colonized) {
                    el.style.border = '3px solid var(--primary)';
                }
                
                document.querySelector('.space-container').appendChild(el);
            });
        }
        
        // ìš°ì£¼ì„  ìœ„ì¹˜ ì—…ë°ì´íŠ¸
        function updateShip() {
            const ship = document.getElementById('ship');
            ship.style.left = gameState.shipX + 'px';
            ship.style.top = gameState.shipY + 'px';
        }
        
        // í–‰ì„± ì„ íƒ
        function selectPlanet(planet) {
            selectedPlanet = planet;
            document.getElementById('planetInfo').style.display = 'block';
            document.getElementById('planetName').textContent = planet.name;
            
            const distance = Math.sqrt(
                Math.pow(planet.x - gameState.shipX, 2) + 
                Math.pow(planet.y - gameState.shipY, 2)
            );
            document.getElementById('planetDistance').textContent = Math.round(distance);
            document.getElementById('planetSize').textContent = Math.round(planet.size) + 'km';
            document.getElementById('planetResource').textContent = 
                planet.explored ? `${planet.resource} (${planet.resourceAmount})` : 'ë¯¸í™•ì¸';
        }
        
        // ì£¼ë³€ ìŠ¤ìº”
        function scanArea() {
            if (gameState.energy < 10) {
                alert('ì—ë„ˆì§€ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            gameState.energy -= 10;
            
            // ìƒˆ í–‰ì„± ë°œê²¬
            const newPlanets = Math.floor(Math.random() * 3) + 1;
            for (let i = 0; i < newPlanets; i++) {
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * 200 + 100;
                const planet = generatePlanet(
                    gameState.shipX + Math.cos(angle) * distance,
                    gameState.shipY + Math.sin(angle) * distance
                );
                gameState.planets.push(planet);
            }
            
            addLog(`ìŠ¤ìº” ì™„ë£Œ: ${newPlanets}ê°œì˜ ìƒˆë¡œìš´ í–‰ì„± ë°œê²¬!`);
            updateDisplay();
            saveGame();
        }
        
        // ì›Œí”„ ì í”„
        function warpJump() {
            if (gameState.energy < 50) {
                alert('ì—ë„ˆì§€ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            gameState.energy -= 50;
            gameState.shipX = Math.random() * canvas.width;
            gameState.shipY = Math.random() * canvas.height;
            
            // ìƒˆë¡œìš´ êµ¬ì—­ ìƒì„±
            gameState.planets = [];
            const planetCount = Math.floor(Math.random() * 5) + 3;
            for (let i = 0; i < planetCount; i++) {
                gameState.planets.push(generatePlanet());
            }
            
            addLog('ì›Œí”„ ì í”„ ì™„ë£Œ! ìƒˆë¡œìš´ êµ¬ì—­ì— ë„ì°©í–ˆìŠµë‹ˆë‹¤.');
            updateDisplay();
            saveGame();
            location.reload(); // í™”ë©´ ìƒˆë¡œê³ ì¹¨
        }
        
        // í–‰ì„± íƒì‚¬
        function explorePlanet() {
            if (!selectedPlanet) return;
            
            const distance = Math.sqrt(
                Math.pow(selectedPlanet.x - gameState.shipX, 2) + 
                Math.pow(selectedPlanet.y - gameState.shipY, 2)
            );
            
            if (distance > 100) {
                alert('ë„ˆë¬´ ë©€ë¦¬ ìˆìŠµë‹ˆë‹¤! ê°€ê¹Œì´ ì´ë™í•˜ì„¸ìš”.');
                return;
            }
            
            if (gameState.energy < 20) {
                alert('ì—ë„ˆì§€ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!');
                return;
            }
            
            gameState.energy -= 20;
            selectedPlanet.explored = true;
            
            // ìì› íšë“
            if (selectedPlanet.resource === 'í¬ë¦¬ìŠ¤íƒˆ') {
                gameState.crystal += selectedPlanet.resourceAmount;
                addLog(`${selectedPlanet.name} íƒì‚¬ ì™„ë£Œ! í¬ë¦¬ìŠ¤íƒˆ ${selectedPlanet.resourceAmount} íšë“`);
            } else if (selectedPlanet.resource === 'ì—ë„ˆì§€') {
                gameState.energy += selectedPlanet.resourceAmount;
                addLog(`${selectedPlanet.name} íƒì‚¬ ì™„ë£Œ! ì—ë„ˆì§€ ${selectedPlanet.resourceAmount} ì¶©ì „`);
            } else {
                addLog(`${selectedPlanet.name} íƒì‚¬ ì™„ë£Œ! ${selectedPlanet.resource} ë°œê²¬`);
            }
            
            gameState.discovered++;
            updateDisplay();
            saveGame();
        }
        
        // ì‹ë¯¼ì§€í™”
        function colonizePlanet() {
            if (!selectedPlanet || !selectedPlanet.explored) {
                alert('ë¨¼ì € í–‰ì„±ì„ íƒì‚¬í•´ì•¼ í•©ë‹ˆë‹¤!');
                return;
            }
            
            if (gameState.crystal < 50) {
                alert('í¬ë¦¬ìŠ¤íƒˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤! (í•„ìš”: 50)');
                return;
            }
            
            gameState.crystal -= 50;
            selectedPlanet.colonized = true;
            
            // ì§€ì†ì ì¸ ìì› ìƒì‚° ì‹œì‘
            addLog(`${selectedPlanet.name}ì„ ì‹ë¯¼ì§€í™”í–ˆìŠµë‹ˆë‹¤!`);
            updateDisplay();
            saveGame();
        }
        
        // ë¡œê·¸ ì¶”ê°€
        function addLog(message) {
            gameState.logs.unshift({
                time: new Date().toLocaleTimeString(),
                message: message
            });
            
            if (gameState.logs.length > 20) {
                gameState.logs = gameState.logs.slice(0, 20);
            }
            
            displayLogs();
        }
        
        // ë¡œê·¸ í‘œì‹œ
        function displayLogs() {
            const logContainer = document.getElementById('logEntries');
            logContainer.innerHTML = gameState.logs.map(log => 
                `<div class="log-entry">[${log.time}] ${log.message}</div>`
            ).join('');
        }
        
        // ë””ìŠ¤í”Œë ˆì´ ì—…ë°ì´íŠ¸
        function updateDisplay() {
            document.getElementById('energy').textContent = gameState.energy;
            document.getElementById('crystal').textContent = gameState.crystal;
            document.getElementById('discovered').textContent = gameState.discovered;
            updateShip();
        }
        
        // ê²Œì„ ì €ì¥
        function saveGame() {
            localStorage.setItem('spaceExplorer', JSON.stringify(gameState));
        }
        
// ìš°ì£¼ì„  ì´ë™
canvas.addEventListener('click', (e) => {
    const rect = canvas.getBoundingClientRect();
    const targetX = e.clientX - rect.left;
    const targetY = e.clientY - rect.top;
    
    const distance = Math.sqrt(
        Math.pow(targetX - gameState.shipX, 2) + 
        Math.pow(targetY - gameState.shipY, 2)
    );
    
    // ì—ë„ˆì§€ ì†Œë¹„ëŸ‰ ê³„ì‚° (ê±°ë¦¬ì— ë¹„ë¡€)
    const energyCost = Math.round(distance / 10);
    
    if (gameState.energy >= energyCost) {
        gameState.energy -= energyCost;
        gameState.shipX = targetX;
        gameState.shipY = targetY;
        
        // ìš°ì£¼ì„  ìœ„ì¹˜ ì—…ë°ì´íŠ¸
        updateShip();
        
        // UI ì—…ë°ì´íŠ¸
        updateDisplay();
        
        // ê²Œì„ ìƒíƒœ ì €ì¥
        saveGame();
        
        addLog(`ìš°ì£¼ì„  ì´ë™ ì™„ë£Œ (ì—ë„ˆì§€ -${energyCost})`);
    } else {
        addLog('ì—ë„ˆì§€ê°€ ë¶€ì¡±í•˜ì—¬ ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
    }
});

// ì´ˆê¸°í™”
window.addEventListener('load', () => {
    createStars();
    drawStars();
    updateDisplay();
    drawPlanets();
    displayLogs();
});

// í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì •
window.addEventListener('resize', () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    drawStars();
});